论文整理


| 算法                     | 单标签 | 多标签(AND) | 多标签(OR) | 范围查询 | OOD 表现 | 复杂布尔逻辑 | 动态插入删除 | 多/单线程(查询) | 备注                                                         |
| :----------------------- | :----- | :---------- | :--------- | :------- | :------- | :----------- | :----------- | :-------------- | :----------------------------------------------------------- |
| filtered-diskann（论文） | Y      | N           | Y          | Y        | Y        | N            | Y            | All             |                                                              |
| SeRF（论文）             | Y      | Y           | Y          | Y        | /        | N            | Y            | 单              |                                                              |
| ACORN（论文）            | Y      | Y           | Y          | Y        | N        | N            | N            | All             |                                                              |
| faiss-ivf                | Y      | Y           | Y          | Y        | /        | Y            | Y            | All             |                                                              |
| HQI_batch（论文）        | Y      | Y           | Y          | Y        | /        | Y            | Y            | All             | 基于faiss-ivf实现的HQI中批量查询部分                         |
| SPTAG                    | Y      | Y           | Y          | Y        | /        | Y            | N            | All             |                                                              |
| VBASE（论文）            | Y      | Y           | Y          | Y        | /        | Y            | Y            | All             |                                                              |
| PASE（论文）             | Y      | Y           | Y          | Y        | /        | Y            | Y            | All             |                                                              |
| Milvus（论文）           | Y      | Y           | Y          | Y        | /        | Y            | Y            | All             |                                                              |
| RoarGraph（论文）        | N      | N           | N          | N        | Y        | N            | Y            | Y               |                                                              |
| NHQ（论文）              | Y      | Y           | N          | N        | /        | N            | /            | 单              |                                                              |
| Irange(论文)             | N      | N           | N          | Y        | /        | N            | N            | 单              |                                                              |
| Puck                     | Y      | Y           | Y          | N        | Y        | N            | Y            | All             |                                                              |
| ParlayAnn（论文）        | Y      | Y           | Y          | Y        | Y        | N            | /            | All             | 该算法对diskann、hnsw、hcnng、nndescent进行了并行优化。文档中写支持范围查询，还没测试。 |

# 1. iRangeGraph Improvising Range-dedicated Graphs for Range-filtering Nearest Neighbor Search

## 核心思想

iRangeGraph通过段树结构解决范围过滤近似最近邻搜索问题。该方法在索引阶段按层划分数据范围，动态构建查询专用图，从而显著降低存储开销和提升查询性能。

## 系统架构

### 1. 索引构建阶段

基于段树结构构建多层索引：

- 每层将数据范围[1,n]划分为2^i个等长片段
- 为每个片段构建基于RNG(相对邻近图)的基本图
- 每个数据对象在每层只出现一次，最大出度为m


### 2. 查询处理阶段

#### 2.1 动态构建专用图

- 按需构建边：仅在访问对象邻居时构建
- 基于查询范围与段的关系确定边的保留
- 优先选择查询范围重叠度高的段中的边


#### 2.2 边选择算法

- 自上而下遍历段树层次
- 相同交集时跳过该层
- 完全覆盖时停止选择
- 时间复杂度：O(m + log n)


#### 2.3 搜索策略

- 在动态构建图上执行贪心波束搜索
- 仅访问满足范围约束的对象
- 通过波束大小调整效率与精度平衡


## 技术创新

### 1. 避免全范围预构建

- 仅为O(log n)层的段构建基本图
- 空间复杂度优化至O(nm log n)


### 2. 高效实时图构建

- 利用段树结构跳过冗余层
- 基于范围重叠关系剪枝
- 按需构建边


## 性能优化

- 存储开销：从O(n³m)降至O(nm log n)
- 边选择算法复杂度：O(m + log n)


# 2. An Efficient and Robust Framework for Approximate Nearest Neighbor Search with Attribute Constraint

## 核心创新点

1. 提出融合距离(Merged Distance)概念，实现混合索引，支持特征向量和属性约束查询
2. 设计新型可导航近邻图算法，优化边选择和路由策略

## 技术实现

### 1. 融合距离设计

- 通过公式定义融合距离
- 标签距离通过计算对象间相同属性数来衡量
- 索引构建时同时考虑向量相似度和标签相似度，构建PG混合索引


### 2. 图优化策略

#### 边选择策略优化

- 解决传统邻居选择容易聚集的问题
- 引入"着陆区"概念，确保邻居分布均匀
- 使用垂直平分线和距离圆划分空间，从着陆区选取新邻居


#### 两阶段路由策略

- 初始阶段：随机选点探索
- 靠近目标后：切换为贪心策略
- 减少访问点数量和计算开销


## 系统优势

### 1. 单一索引实现

- 避免维护双索引带来的内存和计算开销
- 提高查询精确度
- 更好地适配PG图特性


### 2. 查询效率

- 支持多标签同时满足
- 无需分解为独立的向量相似性搜索和属性过滤任务


## 局限性

### 1. 标签限制

- 主要适用于单个过滤器标签场景
- 各标签点集合需要满足不相交条件


### 2. 扩展性问题

- 难以扩展到多过滤器/标签场景
- 多余标签影响总距离计算
- 难以同时保持高召回率和处理复杂多标签情况


# 3.Filtered − DiskANN: Graph Algorithms for Approximate Nearest Neighbor Search with Filters

## 核心创新点

1. **高效图算法设计**
   - 提出 FilteredVamana 和 StitchedVamana 两种算法
   - 结合向量几何关系和标签信息构建图结构索引
   - 低延迟高召回率（>90%），支持每秒数千次查询
2. **大规模标签支持**
   - 支持数千个过滤标签 (|F| ≈ 1000)
   - 支持数据点关联多个标签
   - FilteredVamana 支持动态索引增长
3. **SSD 存储支持**
   - 支持基于 SSD 的索引存储和查询
   - 在大规模数据集上保持低延迟和高召回率

## 算法实现

### FilteredVamana

- 增量式构建方式
- 初始化空图 G，为每个过滤标签选择起点集 S
- 运行 FilteredGreedySearch 搜索算法
- 使用 FilteredRobustPrune 进行剪枝


### StitchedVamana

- 为每个过滤标签构建 vamana 图
- 通过边集并运算合并成图 G
- 需要提前知道点集，不支持增量构建


## 算法比较

### FilteredVamana

- 支持动态索引增长
- 稳健性更好
- 索引构建更快


### StitchedVamana

- 不支持动态索引增长
- QPS 和召回率表现更好


## 系统优势

1. 索引融合过滤信息
2. 支持 SSD 查询，节约内存
3. 稀疏属性不受影响
4. 支持动态插入

## 系统局限

1. 不支持复杂过滤条件
2. 仅支持简单枚举型条件
3. 支持条件 OR，不支持 AND
4. 仅适用于单个过滤器场景

# 4. SeRF: Segment Graph for Range-Filtering Approximate Nearest Neighbor Search

## 核心创新点

1. **新型索引结构 Segment Graph**
   - 处理范围过滤的近似最近邻搜索
   - 高效处理属性范围约束的向量相似性搜索
   - 解决传统方法在不同范围查询效率低下问题
2. **高效压缩 HNSW 索引**
   - 适用于半有界范围查询
   - 保持与单个 HNSW 索引相同的时空复杂度
   - 显著降低索引成本
3. **2D Segment Graph**
   - 优化索引构建过程
   - 减少索引时间和空间开销

## 技术实现

### 1. 段图 (Segment Graph)

#### 核心思想

- 每个查询范围对应一个 HNSW 索引
- 通过无损压缩合并所有 HNSW 索引


#### 构建过程

1. **增量构建 HNSW 索引**
   - 按属性值顺序插入节点
   - 构建系列 HNSW 索引
2. **边生命周期记录**
   - 记录边的起始和结束时间戳
   - 标记边在不同 HNSW 索引中的存在性
3. **无损压缩**
   - 利用时间戳压缩所有索引
   - 实现高效查询支持

### 2. 二维段图 (2D Segment Graph)

#### 特点

- 支持任意范围查询
- 使用二维区间表示边的存在范围
- 应用跳跃策略优化构建过程


#### 构建过程

1. **初始化**
   - 从首个数据点开始
   - 逐步扩展查询范围
2. **跳跃策略**
   - 基于最近邻点属性值进行跳跃
   - 动态选择查询范围起点
3. **动态更新**
   - 根据跳跃策略更新边的二维区间
   - 形成最终的二维段图

## 优化策略

1. **Leap Optimization**
   - 通过多种跳跃点选择优化索引构建
   - 支持最小值、中值、最大值等选择
2. **多属性查询支持**
   - 构建多个单属性索引
   - 支持复合属性索引

# 5. RoarGraph: A Projected Bipartite Graph for Efficient Cross-Modal Approximate Nearest Neighbor Search

## 实现架构

算法分为五个主要阶段：

1. 从跨模态数据提取特征向量
2. 基于历史查询分布构建查询和基础数据间的二分图
3. 建立查询节点至最近基础数据的反向连接
4. 将二分图投影到仅含基础数据的投影图
5. 对投影图进行连通性增强

## 具体实现

### 1. 二分图构建

- 计算历史查询节点与基础数据间最近邻的 groundtruth
- 建立查询节点到最近基础节点的反向边连接


### 2. 二分图投影

1. 连接步骤
   - 连接与 P 最近的候选节点
   - 在候选队列中执行邻居获取算法
2. 邻居选择
   - 判断候选节点与枢轴及其邻居的距离关系
   - 如果枢轴是最近节点，则建立连接
   - 在度数 M 限制下添加反向边

### 3. 连通性增强

- 对每个节点 x 执行波束搜索
- 获取长度为 L 的候选队列
- 将 x 作为枢轴，连接候选队列中的节点
- 在度数 M 限制下添加反向边


## 系统评估

### 优势

- OOD (Out-of-Distribution) 负载下表现优异
- 高召回率
- 高查询速度


### 局限性

对查询训练数据集要求严格：

- 需要体现所有查询的整体分布
- 训练集规模需接近基础数据集大小


# 6. ACORN: Performant and Predicate-Agnostic Search Over Vector Embeddings and Structured Data

## 系统概述

ACORN 基于 HNSW 实现，提出遍历谓词子图的思想，通过仅遍历满足属性过滤条件的节点来模拟理想的混合搜索策略。系统包含两种索引实现：ACORN-γ 和 ACORN-1。

## ACORN-γ 实现

### 核心参数

- 邻居列表扩展因子 γ
- 压缩因子 Mβ
- 标准 HNSW 参数 M


### 索引构建修改

1. **邻居列表扩展**
   - HNSW: 每节点保留 M 个近似最近邻
   - ACORN: 每节点保留 M*γ 个近似最近邻
2. **索引压缩**
   - 保留最近的 Mβ 个候选邻居
   - 比较剩余候选与二跳邻居
   - 相同时进行剪枝

### 搜索过程

- 遍历节点邻居和二跳邻居
- 忽略不满足属性过滤的邻居
- 通过位图实现谓词子图遍历
- 基于查询属性和基础数据属性修改位图


## ACORN-1 实现

### 设计目标

- 近似 ACORN-γ 的搜索性能
- 最小化索引大小和构建时间
- 适用于资源受限环境


### 技术特点

- 搜索期间执行邻域扩展
- 基于原始 HNSW 索引构造
- 固定参数：γ = 1，Mβ = M
- 无需额外修剪操作


# 7. High-Throughput Vector Similarity Search in Knowledge Graphs

## 系统概述

HQI (Hybrid Query Index) 是一种工作负载感知的混合查询索引系统，用于向量数据库。通过工作负载感知索引和批量查询优化，提高大规模知识图谱上混合查询的处理效率。

## 核心组件

### 1. qd-tree 构建

#### 设计思路

- 提出工作负载感知的向量索引方案
- 扩展 qd 树支持多属性谓词和向量相似性约束
- 实现查询执行时的分区剪枝


#### 实现细节

1. **初始化**
   - 引入 k-means 聚类质心表示向量相似性约束
   - 提取属性约束中的一元布尔谓词
2. **树构建算法**
   - 基于改进的贪婪构造算法
   - 从单个分区递归创建平衡分割
   - 使用位图表示节点语义描述
3. **分区优化**
   - 选择多个切割谓词实现平衡
   - 最小化分区访问成本
   - 在各分区创建 ANN 索引

### 2. 批量处理优化

#### 处理步骤

1. 基于属性约束对查询分组
2. 获取查询向量最近质心
3. 计算候选向量距离
4. 更新查询结果最小堆

## 系统优势

1. **工作负载感知索引**
   - 利用谓词频率信息优化
   - 减少不必要的元组扫描
   - 提升查询效率
2. **多属性支持**
   - 支持多属性谓词分区
   - 适用于复杂混合查询
   - 特别适合知识图谱查询
3. **批量处理优化**
   - 共享计算资源
   - 减少重复运算
   - 提高整体吞吐量
4. **索引结合策略**
   - 结合 IVF 等 ANN 索引
   - 优化分区内相似性查询

## 系统局限

1. **构建复杂度**
   - 依赖 qd 树构建
   - 大量谓词时计算开销大
2. **批处理局限性**
   - 主要适用于批量场景
   - 实时响应效果受限
3. **工作负载依赖**
   - 需要稳定的历史查询模式
   - 适应性受工作负载影响
4. **性能平衡问题**
   - 分区策略复杂
   - 高选择性查询可能性能下降

# 8. VBase: Unifying Online Vector Similarity Search and Relational Queries via Relaxed Monotonicity

## 系统概述

VBASE 是一个基于 PostgreSQL 的数据库系统，支持高效处理近似相似性搜索和关系运算符的复杂查询。系统基于向量索引的两阶段模式，引入松弛单调性概念，构建统一的查询执行引擎。

## 核心技术

### 1. 松弛单调性定义

#### 两阶段特性

- **第一阶段**：向量距离波动大，但整体接近目标向量区域
- **第二阶段**：遍历趋于稳定，逐渐远离目标向量区域


#### 应用价值

- 判断向量索引遍历的阶段状态
- 绕过 TopK-only 接口的限制
- 支持查询的提前终止


### 2. 统一查询执行引擎

#### 基础架构

- 基于 Volcano 模型
- 复用 Open、Next、Close 接口
- 保持传统索引兼容性


#### 优化特性

- 遍历过程中进行过滤
- 支持灵活的终止条件
- 优化 TopK 和范围查询


## 系统优势

1. **接口优化**
   - 克服 TopK 接口限制
   - 将属性过滤融入遍历过程
2. **理论创新**
   - 提出松弛单调性概念
   - 揭示向量索引设计核心
3. **查询支持**
   - 支持多列向量查询
   - 支持范围过滤查询
   - 实现统一引擎等效结构

## 系统局限

1. **参数固定**
   - 编译后无法调整参数
   - 性能优化空间受限
2. **实现复杂**
   - 需修改向量索引源码
   - 参数调整需多次优化
   - 调试过程复杂耗时

# 9. PASE: PostgreSQL Ultra-High-Dimensional  Approximate Nearest Neighbor Search Extension

## 系统概述

PASE (PostgreSQL Ultra-High-Dimensional ANN Search Extension) 是基于 PostgreSQL 的扩展系统，专注于高维向量的近似最近邻搜索。系统通过扩展索引类型实现高维向量检索，支持复合查询，并与现有业务数据无缝集成。

## 核心技术实现

### 1. 索引设计与算法选择

#### IVFFlat 算法

- 基于聚类的量化算法
- 将向量数据划分为多个簇
- 在最近簇中进行精确搜索
- 优点：高精度和快速索引构建


#### HNSW 算法

- 基于图的多层邻接结构
- 适用于大规模数据集
- 提供严格延迟要求下的高效检索


### 2. 页面存储优化

#### 连续存储

- 分配连续页面块存储索引
- 减少随机访问开销


#### 跨页存储

- 处理超大向量数据
- 将向量分割存储于多页


### 3. 复合查询支持

- 支持多条件组合查询
- 实现迭代搜索机制
- 高效处理复合条件过滤


## 系统优势

1. **性能优化**
   - 优化索引结构
   - 优化页面存储
   - 提升检索效率
2. **查询能力**
   - 高精度检索结果
   - 支持多场景应用
   - 复杂复合查询支持
3. **系统特性**
   - 提供通用算法框架
   - 与 PostgreSQL 深度集成
   - 无需额外数据复制

## 系统局限

1. **算法限制**
   - 算法场景适配性问题
   - 需根据需求选择算法
2. **资源消耗**
   - HNSW 存储空间开销大
   - 邻接图信息占用大
3. **效率问题**
   - "先搜再过滤"效率低
   - 结果完整性不保证
4. **维度约束**
   - 限制在 512 维以下
   - 高维适配仍在开发

# 10. Milvus: A Purpose-Built Vector Data Management System

## 系统概述

Milvus 是专为高维向量数据管理设计的系统，支持大规模动态向量数据处理。系统集成了向量相似性搜索、属性过滤和多向量查询等功能，通过异构计算平台优化和分布式架构实现高性能和高可用性。

## 核心功能实现

### 1. 属性过滤

- 支持在向量搜索中加入非向量属性约束
- 实现多种过滤策略：
  - 基于成本的策略
  - 分区策略
- 采用属性分区优化查询效率
  - 基于频繁搜索属性分区
  - 仅搜索相关分区


### 2. 多向量查询

#### 支持特性

- 允许实体多向量描述
- 适用于复杂场景（如多角度人脸识别）


#### 查询算法

1. **向量融合**
   - 合并多向量为单一向量
   - 适用于可分解相似性函数（如内积）
2. **迭代合并**
   - 基于 Fagin NRA 算法
   - 适用于不可分解相似性函数
   - 通过迭代优化查询效率

## 系统优势

1. **查询能力**
   - 支持复杂混合查询
   - 支持多维度属性过滤
   - 支持多向量处理
2. **性能优化**
   - 优化异构计算平台
   - 高效分区策略
   - 优秀的大规模数据处理能力
3. **系统特性**
   - 支持分布式部署
   - 线性扩展能力
   - 丰富的应用接口

## 系统局限

1. **实现复杂度**
   - 系统实现复杂
   - 优化策略复杂
   - 开发调试成本高
2. **资源消耗**
   - 分布式部署资源需求大
   - 硬件要求高
3. **调优难度**
   - 参数配置复杂
   - 需要精细化调整
   - 性能优化依赖经验
